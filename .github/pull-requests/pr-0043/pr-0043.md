---
pr_number: 43
title: Optimize fireworks performance
state: MERGED
status: MERGED
is_draft: false
created_at: '2026-01-01T02:24:20Z'
updated_at: '2026-01-01T02:26:11Z'
closed_at: '2026-01-01T02:25:29Z'
merged_at: '2026-01-01T02:25:29Z'
author: wclaytor
labels: []
assignees: []
milestone: null
head_ref: 42-improve-fireworks-performance
base_ref: main
additions: 151
deletions: 108
changed_files: 1
review_decision: ''
url: https://github.com/wclaytor/wclaytor.github.io/pull/43
---

# PR #43: Optimize fireworks performance

**Status**: `MERGED` âœ… | **Branch**: `42-improve-fireworks-performance` â†’ `main`

**Changes**: +151 -108 across 1 files

## Description

Optimize fireworks performance by reducing particle counts, simplifying trails, and caching gradients. Adjust launch intervals and resize handling for improved efficiency.

## Comments

### Comment by @wclaytor - 2026-01-01 02:25:01

## ðŸŽ† Performance Optimizations Complete

I've implemented comprehensive performance improvements to fix the fireworks lag issue:

### Key Changes:

**1. Canvas & Memory Optimizations**
- Disabled alpha channel on canvas context for faster compositing
- Cached sky gradient (was creating new one every frame)
- Added color parsing cache to avoid repeated hex-to-RGB conversions

**2. Object Limits (prevents unbounded growth)**
- Max 800 particles (was unlimited)
- Max 15 rockets (was unlimited)  
- Max 100 confetti (was 150)

**3. Eliminated Expensive Gradient Creation**
- Replaced per-particle radial gradients with simple `globalAlpha` + solid fills
- Simplified rocket trail rendering (removed gradients)

**4. Fixed Memory Allocation**
- Replaced dynamic trail arrays with pre-allocated `Float32Array` ring buffers
- No new object creation during animation loop

**5. Reduced Particle Counts**
- Explosion particles: 80-120 (was 150-250)
- Flash particles: 5 (was 10)
- Extra sparkles: 15 (was 30)
- Trail length: 5 (was 8)

**6. Early Culling**
- Skip drawing very faded particles (alpha < 0.05)
- Remove off-screen particles immediately
- Limit stars to max 200

The fireworks display should now maintain smooth 60fps performance even after extended viewing! âœ¨

[View on GitHub](https://github.com/wclaytor/wclaytor.github.io/pull/43#issuecomment-3703181345)

---

## Implementation Notes

_Add your implementation notes, decisions, and documentation here._

## Testing Notes

_Document testing performed, results, and any issues discovered._

## Review Notes

_Add code review feedback, suggestions, and action items._
